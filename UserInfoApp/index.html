<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>UserInfo App</title>
</head>
<body>

   <div>
        <h2>User Information</h2>
        <h3>Please enter Username</h3>
        <input type="text" id="userName" size="5" />
        <h3>Please enter First Name</h3>
        <input id="firstName" size="5" name="name" value="" required pattern="[A-Za-z]+\s[A-Za-z]+" title="firstname">
        <!--<input type="text" id="firstName" size="5" />-->
        <h3>Please enter Last Name</h3>
       <input id="lastName" size="5" name="name" value="" required pattern="[A-Za-z]+\s[A-Za-z]+" title="lastname">
        <!--<input type="text" id="lastName" size="5" />-->
        <input type="button" value="Submit" onclick="add();" />
    </div>
    
    <div>
        <h2>Get all Usernames section</h2>
        <input type="button" value="Get All Users" onclick="getAllUsers();" />
        <div id="temp">
            <ul id="userInfo"></ul>
        </div>
    </div>

    <div>
        <h2 style="text-align:center">LIBRARY SYSTEM</h2>
        <div>
            <h3>Please enter User Name</h3>
            <input type="text" id="user_name" />
            <input type="button" value="Submit" onclick="getBooks();" />
        </div>

        <div id="bookDetails" hidden="hidden">
            <h3>List of books</h3>
            <table id="bookTable">
                <tr>
                    <th>Book Name</th>
                    <th>Availability</th>
                    
                </tr>
                
            </table>         
        </div>
    </div>

    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
    <script>
        var uri = 'api/userInfo';
        var uri1 = 'api/booksLibrary';
   
        function getAllUsers() {
     
          $.getJSON(uri + '/')
              .done(function (data) {
                  $.each(data, function (key, item) {
                      $('<li>', { text: item}).appendTo('#userInfo');
                  });
              })
              .fail(function (jqXHR, textStatus, err) {
                $('#userInfo').text('Error: ' + err);
              });
        }

        function add() {
            var userName = $('#userName').val();
            var firstName = $('#firstName').val();
            var lastName = $('#lastName').val();
            var uri_put = 'api/userInfo/?userName=' + userName + '&firstName=' + firstName + '&lastName=' + lastName;
            $.ajax({
                url: uri_put,
                type: 'PUT',
                success: function (result) {

                }
            });
        }

        function getBooks() {
            
            $.getJSON(uri1 + '/')
                .done(function (data) {

                    $.each(data, function (key, item) {
                        if (key == "Data") {
                            item = JSON.parse(item);
                            $.each(item, function (key1, item1) {
                                var row = $("<tr>");
                                row.append($("<td>").text(item1.bookname));
                                row.append($("<td>").text(item1.availability));
                                row.append($("<button class='check'>").text('CheckOut'));
                                $("#bookTable").append(row);
                            });
                        }
                    });
                   
                    $('#bookDetails').show();
                })
                .fail(function (jqXHR, textStatus, err) {
                    $('#userInfo').text('Error: ' + err);
                });
           
        }

    </script>
</body>
</html>